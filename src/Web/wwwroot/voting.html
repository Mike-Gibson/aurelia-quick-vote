<template>
  <div class="app-row" style="top: 0; bottom: 0">
    
    <div class="app-col padded" style="left: 0; width: 75%">
      <div class="panel panel-default">
        <div class="panel-body" show.bind="question === null">
          Waiting for the vote to be started...
        </div>
        
        <div class="panel-body" show.bind="question !== null">
          <h3>Question: ${question.title}</h3>          
          
          <br />
          
          <div show.bind="question.active">
            <div class="progress" style="margin-bottom: 4px;">
              <div class="progress-bar progress-bar-striped active" style.bind="{ width: status.percentage }" style="min-width: 2em;">
                <span>${status.percentage}</span>
              </div>
            </div>
            
            <div class="text-center">
              <strong>${status.votedPeople}</strong> votes out of <strong>${status.totalPeople}</strong>
            </div>
          </div>
          
          <br />
          
          <style>           
            .results > div {
              display: inline-block; 
              /*float: left;*/
              min-width: 140px;
              margin: 4px;
              vertical-align: top;
            }            
          </style>
          
          <div show.bind="!question.active">
            <p>
              <b>Results</b>
            </p>
            
            <div class="results au-stagger">              
              <div repeat.for="result of question.results" class="panel au-animate animation-fade ${ result.result ? 'panel-primary': 'panel-default' }">
                <div class="panel-heading">
                  ${result.name}
                </div>
                <div class="panel-body text-center">
                  <span show.bind="result.result">
                    ${result.result}
                  </span>
                  <span show.bind="!result.result" style="color: #AAA">
                    <i>(no vote)</i>
                  </span>                  
                </div>
              </div>              
            </div>
          </div>
        </div>
      </div>
      
      <form role="form" submit.delegate="submitVote()">
        <div show.bind="question.active">
          <div class="form-group">
            <label for="newVote">My Vote</label>
            <input type="text" value.bind="newVote" class="form-control" id="newVote" placeholder="Enter your vote">
          </div>
          
          <button type="submit" class="btn btn-default" disabled.bind="newVote === '' || newVote === currentVote">
            ${currentVote === '' ? 'Vote' : 'Update Vote'}
          </button>
        </div>
      </form>
      
      <button click.delegate="temp_endVote()">TEMP - end vote</button>
      <button click.delegate="temp_startVote()">TEMP - start vote</button>
      
    </div>
    
    <style>
      ul.user-list {
        overflow: auto;
        list-style-type: none;
        margin: 0;
        padding: 0;
        background-color: white;
      }
      
      ul.user-list li {
        
        margin: 0px;
        border-bottom: 1px solid #ddd;
        
      }
      
      ul.user-list li > .vote {
        display: inline-block;        
        height: 100%;
        margin-left: 12px;
        background-color: green;
        border-radius: 4px;
        width: 20px;
      }
      
      ul.user-list li > .vote-voted {        
        background-color: green;
      }
      
      ul.user-list li > .vote-notvoted {        
        background-color: orange;
      }
      
      ul.user-list li > .name {
        display: inline-block;
        margin: 0px;
        padding: 12px;
      }  
      
    </style>
    
    <div class="app-col padded" style="width: 25%; right: 0">
      
      <div class="panel panel-default" style="height: 100%; overflow: hidden;">
        <div class="panel-body scroll-y" style="height: 100%; padding: 0; background-color: #fefefe">
          <ul class="user-list">
            <li repeat.for="person of people">
              <span class.bind="'vote ' + (person.hasVoted ? 'vote-voted' : 'vote-notvoted')">&nbsp;</span>
              <span class="name">${person.name}</span>
            </li>
          </ul>
      </div>
      
    </div>
    
  </div>
  
</template>